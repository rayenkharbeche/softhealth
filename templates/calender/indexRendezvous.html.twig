{% extends 'baseP.html.twig' %}

{% block title %}Rendez Vous{% endblock %}

    {% block stylesheets %}
        <style>
            #calendrier{
                width: 60%;
                margin: auto;
            }
        </style>
    {% endblock %}
{% block body %}

    <div id="calendrier"></div>



{% endblock %}
{% block javascripts %}
    <script>
        window.onload =() => {
            let calendarElt =document.querySelector("#calendrier")

            let calendar = new FullCalendar.Calendar(calendarElt, {
                initialView: 'timeGridWeek',
                locale : 'fr',
                timeZone : 'Europe/Paris',
                headerToolbar: {
                    start: 'prev, next today',
                    center: 'title',
                    end: 'dayGridMonth,timeGridWeek'
                },
                events: {{ data|raw }},
                editable: true,
                eventResizableFromStart: true

            })

            calendar.on('eventChange',(e)=> {
                let url = `/api/${e.event.id}/editR`
                let donnees ={
                    "nomRDV": e.event.nomRDV,
                    "description": e.event.extendedProps.description,
                    "dateRDV": e.event.dateRDV,
                    "plannings": e.event.plannings,
                    "user": e.event.user,
                    "patient": e.event.patient
                }
                let xhr = new XMLHttpRequest
                xhr.open("PUT",url)
                xhr.send(JSON.stringify(donnees))

            })
            calendar.render()
        }
    </script>
{% endblock %}
